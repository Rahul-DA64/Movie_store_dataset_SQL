-- 1.Find the titles of movies except starting with a that have been rented more than 30 times, and sort them in desc order.
SELECT f.title, count(r.rental_id) as rental_count FROM film f
inner join inventory i ON f.film_id = i.film_id
inner join rental r ON r.inventory_id = i.inventory_id
group by i.film_id
Having title NOT like 'a%' and count(r.rental_id)>30
order by rental_count DESC;


-- 2.Find the total revenue generated by store1.
SELECT sum(amount) as store1_revenue from payment inner join store on payment.staff_id = store.manager_staff_id
Where store.store_id = 1;


-- 3.Find the titles of movies in the 'horror' category and sort them based on the last character of the title
SELECT title from film inner join film_category on film.film_id = film_category.film_id
inner join category on film_category.category_id = category.category_id
Where category.name = 'Horror'
order by right(title,1) ASC;


-- 4.Retrieve the top 5 customers whose name starts with E and have made the highest number of rentals. 
-- Display their customer IDs and the total number of rentals they have made.
SELECT c.customer_id, c.first_name, count(r.rental_id) as rent from customer c  inner join rental r on c.customer_id = r.customer_id
group by r.customer_id
Having first_name like 'E%'
order by rent desc
limit 5;

-- 5.Find the total number of films available in each category, and list the categories in descending order of film count.

select c.name, count(fc.film_id) as total_film from category c inner join film_category fc
on c.category_id = fc.category_id
group by fc.category_id
order by count(fc.film_id) desc;


